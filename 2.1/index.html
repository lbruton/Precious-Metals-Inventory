<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, user-scalable=yes">
  <title>Precious Metals Inventory Tool 2.1</title>
  <link rel="stylesheet" href="style.css">

  <!-- External libraries for data import/export functionality -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js" defer></script>
</head>
<body>
  <!-- Main application title -->
  <h1>Precious Metals Inventory Tool 2.1</h1>

  <div class="container">
    <!-- =============================================================================
         SPOT PRICES SECTION
         Displays current spot prices and allows users to set custom spot prices
         Contains separate sections for silver and gold with input controls
         ============================================================================= -->
    <section class="spot-prices">
      <div class="grid grid-2">
        <!-- Silver spot price controls -->
        <div class="spot-input">
          <div class="spot-card">
            <div class="spot-card-label">Current Spot Price</div>
            <div class="spot-card-value" id="spotPriceDisplaySilver">$ -</div>
          </div>

          <label for="userSpotPriceSilver">Silver Spot Price</label>
          <div class="currency-input">
            <input type="number" id="userSpotPriceSilver" min="0" step="0.01" placeholder="Set spot $">
          </div>
          <div class="grid grid-2">
            <button class="btn" id="saveSpotBtnSilver">Save</button>
            <button class="btn" id="resetSpotBtnSilver">Reset</button>
          </div>
        </div>

        <!-- Gold spot price controls -->
        <div class="spot-input">
          <div class="spot-card">
            <div class="spot-card-label">Current Spot Price</div>
            <div class="spot-card-value" id="spotPriceDisplayGold">$ -</div>
          </div>

          <label for="userSpotPriceGold">Gold Spot Price</label>
          <div class="currency-input">
            <input type="number" id="userSpotPriceGold" min="0" step="0.01" placeholder="Set spot $">
          </div>
          <div class="grid grid-2">
            <button class="btn" id="saveSpotBtnGold">Save</button>
            <button class="btn" id="resetSpotBtnGold">Reset</button>
          </div>
        </div>
      </div>
    </section>

    <!-- =============================================================================
         TOTALS SECTION
         Displays aggregated inventory statistics for silver, gold, and combined totals
         Organized into three cards with consistent grouping structure:
         - Basic counts (items, weight)
         - Financial metrics (purchase price, current value, averages)
         - Premium and profit/loss calculations
         ============================================================================= -->
    <section class="totals-section">
      <div class="totals">
        <!-- Silver totals card -->
        <div class="total-card">
          <div class="total-title">Silver Totals</div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Total Items:</span>
              <span class="total-value" id="totalItemsSilver">0</span>
            </div>
            <div class="total-item">
              <span class="total-label">Total Weight:</span>
              <span class="total-value" id="totalWeightSilver">0.00</span> oz
            </div>
          </div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Purchase Price:</span>
              <span class="total-value" id="totalPurchasedSilver">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Current Value:</span>
              <span class="total-value" id="currentValueSilver">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Average Price (oz):</span>
              <span class="total-value" id="avgPriceSilver">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Average Premium (oz):</span>
              <span class="total-value" id="avgPremiumSilver">$0.00</span>
            </div>
          </div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Total Premium Paid:</span>
              <span class="total-value" id="totalPremiumSilver">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Total Loss/Profit:</span>
              <span class="total-value" id="lossProfitSilver">$0.00</span>
            </div>
          </div>
        </div>

        <!-- Gold totals card -->
        <div class="total-card">
          <div class="total-title">Gold Totals</div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Total Items:</span>
              <span class="total-value" id="totalItemsGold">0</span>
            </div>
            <div class="total-item">
              <span class="total-label">Total Weight:</span>
              <span class="total-value" id="totalWeightGold">0.00</span> oz
            </div>
          </div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Purchase Price:</span>
              <span class="total-value" id="totalPurchasedGold">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Current Value:</span>
              <span class="total-value" id="currentValueGold">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Average Price (oz):</span>
              <span class="total-value" id="avgPriceGold">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Average Premium (oz):</span>
              <span class="total-value" id="avgPremiumGold">$0.00</span>
            </div>
          </div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Total Premium Paid:</span>
              <span class="total-value" id="totalPremiumGold">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Total Loss/Profit:</span>
              <span class="total-value" id="lossProfitGold">$0.00</span>
            </div>
          </div>
        </div>

        <!-- Combined totals card -->
        <div class="total-card">
          <div class="total-title">All Totals</div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Total Items:</span>
              <span class="total-value" id="totalItemsAll">0</span>
            </div>
            <div class="total-item">
              <span class="total-label">Total Weight:</span>
              <span class="total-value" id="totalWeightAll">0.00</span> oz
            </div>
          </div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Purchase Price:</span>
              <span class="total-value" id="totalPurchasedAll">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Current Value:</span>
              <span class="total-value" id="currentValueAll">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Average Price (oz):</span>
              <span class="total-value" id="avgPriceAll">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Average Premium (oz):</span>
              <span class="total-value" id="avgPremiumAll">$0.00</span>
            </div>
          </div>

          <div class="total-group">
            <div class="total-item">
              <span class="total-label">Total Premium Paid:</span>
              <span class="total-value" id="totalPremiumAll">$0.00</span>
            </div>
            <div class="total-item">
              <span class="total-label">Total Loss/Profit:</span>
              <span class="total-value" id="lossProfitAll">$0.00</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- =============================================================================
         INVENTORY FORM SECTION
         Allows users to add new inventory items with comprehensive details
         Form is organized into two-column grid for optimal space usage
         Includes validation attributes (required, min, step) for data integrity
         ============================================================================= -->
    <section class="form-section">
      <form id="inventoryForm">
        <!-- First row of form fields -->
        <div class="grid grid-2">
          <div>
            <label for="itemMetal">Metal</label>
            <select id="itemMetal">
              <option value="Silver">Silver</option>
              <option value="Gold">Gold</option>
            </select>
          </div>
          <div>
            <label for="itemType">Type</label>
            <select id="itemType">
              <option value="Round">Round</option>
              <option value="Bar">Bar</option>
              <option value="Coin">Coin</option>
              <option value="Note">Note</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div>
            <label for="itemQty">Quantity</label>
            <input type="number" id="itemQty" min="1" step="1" required>
          </div>
          <div>
            <label for="itemWeight">Weight (oz)</label>
            <input type="number" id="itemWeight" step="0.0001" min="0.0001" required>
          </div>
        </div>

        <!-- Second row of form fields -->
        <div class="grid grid-2">
          <div>
            <label for="itemName">Name</label>
            <input type="text" id="itemName" required>
          </div>
          <div>
            <label for="purchaseLocation">Purchase Location</label>
            <input type="text" id="purchaseLocation" required>
          </div>
          <div>
            <label for="itemPrice">Purchase Price ($)</label>
            <div class="currency-input">
              <input type="number" id="itemPrice" step="0.01" min="0" required>
            </div>
          </div>
          <div>
            <label for="itemDate">Purchase Date</label>
            <input type="date" id="itemDate" required>
          </div>
        </div>

        <!-- Form submission button -->
        <div style="margin-top: 0.5rem;">
          <button type="submit" class="btn">Add to Inventory</button>
        </div>
      </form>
    </section>

    <!-- =============================================================================
         SEARCH FUNCTIONALITY
         Provides real-time filtering of inventory items
         Includes clear button and search results counter
         ============================================================================= -->
    <section class="search-section">
      <div class="search-container">
        <input type="text" id="searchInput" placeholder="Search inventory by metal, name, type, location, date...">
        <button class="btn" id="clearSearchBtn">Clear</button>
      </div>
      <div class="search-results-info" id="searchResultsInfo"></div>
    </section>

    <!-- =============================================================================
         INVENTORY TABLE SECTION
         Displays all inventory items in a sortable, paginated table
         Includes comprehensive columns for all item properties
         Pagination controls allow navigation through large datasets
         ============================================================================= -->
    <section class="table-section">
      <table id="inventoryTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Metal</th>
            <th>Qty</th>
            <th>Type</th>
            <th>Name</th>
            <th>Weight (oz)</th>
            <th>Purchase Price ($)</th>
            <th>Spot Price ($/oz)</th>
            <th>Premium Paid ($/oz)</th>
            <th>Total Premium Paid ($)</th>
            <th>Purchase Location</th>
            <th>Date</th>
            <th>Collectable</th>
            <th>Edit</th>
            <th>Delete</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <!-- Pagination Controls -->
      <section class="pagination-section">
        <div class="pagination-container">
          <div class="pagination-controls">
            <div class="pagination-left">
              <button id="firstPage" class="pagination-btn" title="First Page">&laquo;</button>
              <button id="prevPage" class="pagination-btn" title="Previous Page">&lsaquo;</button>
            </div>

            <div class="pagination-center">
              <div class="page-numbers" id="pageNumbers"></div>
              <div class="pagination-info-controls">
                <span id="paginationInfo" class="pagination-info"></span>
                <select id="itemsPerPage" class="pagination-select">
                  <option value="10">10</option>
                  <option value="15">15</option>
                  <option value="25" selected>25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
              </div>
            </div>

            <div class="pagination-right">
              <button id="nextPage" class="pagination-btn" title="Next Page">&rsaquo;</button>
              <button id="lastPage" class="pagination-btn" title="Last Page">&raquo;</button>
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- =============================================================================
         IMPORT/EXPORT SECTION
         Provides multiple data import and export options
         Organized into two subsections (import and export)
         Supports various file formats for data interoperability
         ============================================================================= -->
    <section class="import-export-section">
      <h2 class="import-export-title">Import Options</h2>
      <div class="import-section import-export-grid">
        <label class="btn" id="importCsvBtn">
          Import CSV
          <input type="file" id="importCsvFile" accept=".csv" hidden>
        </label>

        <label class="btn" id="importJsonBtn">
          Import JSON
          <input type="file" id="importJsonFile" accept=".json" hidden>
        </label>

        <label class="btn" id="importExcelBtn">
          Import Excel
          <input type="file" id="importExcelFile" accept=".xlsx,.xls" hidden>
        </label>
      </div>

      <h2 class="import-export-title">Export Options</h2>
      <div class="export-section import-export-grid">
        <button class="btn" id="exportCsvBtn">Export CSV</button>
        <button class="btn" id="exportJsonBtn">Export JSON</button>
        <button class="btn" id="exportExcelBtn">Export Excel</button>
        <button class="btn" id="exportPdfBtn">Export PDF</button>
        <button class="btn" id="exportHtmlBtn">Export HTML</button>
      </div>
    </section>

    <!-- =============================================================================
         SPOT HISTORY SECTION
         Controls for viewing and managing historical spot price data
         Includes buttons for displaying history and clearing records
         ============================================================================= -->
    <section class="spot-history-section">
      <h2 style="margin-bottom: 0.75rem; text-align: center; font-size: 1.2rem; color: var(--accent);">Spot Price History</h2>
      <div class="spot-history-buttons">
        <button class="btn" id="showSpotHistoryBtn">Show Spot History</button>
        <button class="btn danger" id="clearSpotHistoryBtn">Clear Spot History</button>
      </div>
    </section>
  </div>

  <!-- Theme toggle button positioned at bottom of main content -->
  <div class="theme-toggle" style="margin: 1.5rem 0; justify-content: center;">
    <button class="btn" id="themeToggle">Dark Mode</button>
  </div>

  <!-- "Boating Accident" feature - humorous easter egg button -->
  <section class="boating-accident-section">
    <button id="boatingAccidentBtn">Boating Accident</button>
  </section>

  <!-- =============================================================================
       EDIT MODAL
       Hidden modal dialog for editing inventory items
       Contains form fields mirroring the main inventory form
       Includes spot price field for historical record editing
       ============================================================================= -->
  <div id="editModal" class="modal" style="display: none;">
    <div class="modal-content">
      <h2 style="margin-bottom: 1rem; color: var(--accent);">Edit Inventory Item</h2>
      <form id="editForm">
        <!-- First row of edit form fields -->
        <div class="grid grid-2">
          <div>
            <label for="editMetal">Metal</label>
            <select id="editMetal">
              <option value="Silver">Silver</option>
              <option value="Gold">Gold</option>
            </select>
          </div>
          <div>
            <label for="editType">Type</label>
            <select id="editType">
              <option value="Round">Round</option>
              <option value="Bar">Bar</option>
              <option value="Coin">Coin</option>
              <option value="Note">Note</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div>
            <label for="editQty">Quantity</label>
            <input type="number" id="editQty" min="1" step="1" required>
          </div>
          <div>
            <label for="editWeight">Weight (oz)</label>
            <input type="number" id="editWeight" step="0.0001" min="0.0001" required>
          </div>
        </div>

        <!-- Second row of edit form fields -->
        <div class="grid grid-2">
          <div>
            <label for="editName">Name</label>
            <input type="text" id="editName" required>
          </div>
          <div>
            <label for="editPurchaseLocation">Purchase Location</label>
            <input type="text" id="editPurchaseLocation" required>
          </div>
          <div>
            <label for="editPrice">Purchase Price ($)</label>
            <div class="currency-input">
              <input type="number" id="editPrice" step="0.01" min="0" required>
            </div>
          </div>
          <div>
            <label for="editDate">Purchase Date</label>
            <input type="date" id="editDate" required>
          </div>
        </div>

        <!-- Special field for editing historical spot prices -->
        <div class="grid grid-2">
          <div>
            <label for="editSpotPrice">Spot Price ($/oz)</label>
            <div class="currency-input">
              <input type="number" id="editSpotPrice" step="0.01" min="0" required>
            </div>
          </div>
        </div>

        <!-- Form action buttons -->
        <div style="margin-top: 1rem; text-align: right;">
          <button type="button" class="btn" id="cancelEdit">Cancel</button>
          <button type="submit" class="btn premium">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Main application script -->
  <script src="script.js" defer></script>
</body>
</html>
